# Your First AI Agent with Claude SDK
**Build a simple research agent that searches the web and summarizes findings**

## What You'll Build

A research agent that:
1. Accepts a research topic from the user
2. Searches the web for relevant information
3. Analyzes and summarizes the findings
4. Saves the summary to a markdown file

**Time to complete:** 30-45 minutes
**Prerequisites:** Basic Python knowledge, Claude API key

---

## Setup

### 1. Install Dependencies

```bash
# Create virtual environment
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate

# Install required packages
pip install anthropic python-dotenv
```

### 2. Get Claude API Key

1. Sign up at [console.anthropic.com](https://console.anthropic.com)
2. Navigate to API Keys
3. Create a new API key
4. Copy the key

### 3. Configure Environment

Create `.env` file:
```bash
ANTHROPIC_API_KEY=your_api_key_here
```

---

## Code Walkthrough

### Step 1: Basic Agent Structure

Create `research_agent.py`:

```python
"""
Simple research agent using Claude SDK
"""
import os
from anthropic import Anthropic
from dotenv import load_dotenv

# Load environment variables
load_dotenv()

# Initialize Claude client
client = Anthropic(api_key=os.getenv("ANTHROPIC_API_KEY"))

def research_agent(topic: str) -> str:
    """
    Research a topic and return a summary.

    Args:
        topic: The topic to research

    Returns:
        Markdown-formatted research summary
    """
    response = client.messages.create(
        model="claude-sonnet-4-5",
        max_tokens=4096,
        tools=[
            {
                "name": "web_search",
                "description": "Search the web for information",
                "input_schema": {
                    "type": "object",
                    "properties": {
                        "query": {
                            "type": "string",
                            "description": "The search query"
                        }
                    },
                    "required": ["query"]
                }
            }
        ],
        messages=[{
            "role": "user",
            "content": f"""Research the following topic and provide a comprehensive summary:

Topic: {topic}

Instructions:
1. Search for recent and relevant information
2. Analyze multiple sources
3. Synthesize findings into a clear summary
4. Include key facts, trends, and insights
5. Format the summary as markdown with sections

Provide a well-structured research summary."""
        }]
    )

    return response.content[0].text

if __name__ == "__main__":
    # Example usage
    topic = "AI agent frameworks in 2025"
    summary = research_agent(topic)
    print(summary)
```

**What's happening:**
- We initialize the Anthropic client with our API key
- We define a simple `web_search` tool (Claude will use this to search)
- We send a clear instruction to Claude with the research topic
- Claude autonomously searches, analyzes, and synthesizes the information

### Step 2: Add File Saving

Extend the agent to save results:

```python
def save_summary(topic: str, summary: str) -> str:
    """
    Save research summary to a markdown file.

    Args:
        topic: The research topic (used for filename)
        summary: The markdown summary to save

    Returns:
        Path to the saved file
    """
    # Create safe filename
    filename = f"research_{topic.replace(' ', '_').lower()}.md"

    # Save to file
    with open(filename, 'w') as f:
        f.write(f"# Research Summary: {topic}\n\n")
        f.write(f"*Generated by AI Research Agent*\n\n")
        f.write(summary)

    return filename

def research_agent_with_save(topic: str) -> dict:
    """
    Research a topic and save the summary.

    Returns:
        Dict with summary and file path
    """
    print(f"üîç Researching: {topic}")

    # Get research summary
    summary = research_agent(topic)

    print(f"‚úÖ Research complete!")

    # Save to file
    filepath = save_summary(topic, summary)

    print(f"üíæ Saved to: {filepath}")

    return {
        "summary": summary,
        "filepath": filepath
    }

if __name__ == "__main__":
    result = research_agent_with_save("AI agent frameworks in 2025")
    print(f"\n{result['summary'][:500]}...")
```

### Step 3: Add Streaming for Better UX

Show progress in real-time:

```python
def research_agent_streaming(topic: str) -> str:
    """
    Research agent with streaming output.
    """
    print(f"üîç Researching: {topic}\n")

    summary = ""

    with client.messages.stream(
        model="claude-sonnet-4-5",
        max_tokens=4096,
        messages=[{
            "role": "user",
            "content": f"Research '{topic}' and provide a comprehensive summary."
        }]
    ) as stream:
        for text in stream.text_stream:
            print(text, end="", flush=True)
            summary += text

    print("\n")
    return summary

if __name__ == "__main__":
    result = research_agent_streaming("AI agent frameworks in 2025")
    save_summary("AI agent frameworks in 2025", result)
```

---

## Full Implementation

Here's the complete `research_agent.py`:

```python
"""
AI Research Agent with Claude SDK
================================

A simple agent that researches topics and generates summaries.

Features:
- Web search integration
- Autonomous research and synthesis
- Streaming output for real-time feedback
- Save results to markdown files
"""

import os
from anthropic import Anthropic
from dotenv import load_dotenv
from datetime import datetime

# Load environment variables
load_dotenv()

# Initialize Claude client
client = Anthropic(api_key=os.getenv("ANTHROPIC_API_KEY"))


def research_agent(topic: str, model: str = "claude-sonnet-4-5") -> str:
    """
    Research a topic and return a comprehensive summary.

    Args:
        topic: The topic to research
        model: Claude model to use (default: claude-sonnet-4-5)

    Returns:
        Markdown-formatted research summary
    """
    response = client.messages.create(
        model=model,
        max_tokens=4096,
        messages=[{
            "role": "user",
            "content": f"""Research the following topic and provide a comprehensive summary:

**Topic:** {topic}

**Instructions:**
1. Search for recent and relevant information (2024-2025 preferred)
2. Analyze multiple sources and perspectives
3. Synthesize findings into a clear, structured summary
4. Include key facts, trends, and insights
5. Cite important points when possible
6. Format as markdown with clear sections

**Output Format:**
# {topic}

## Overview
[Brief overview of the topic]

## Key Findings
[Main findings from research]

## Trends and Insights
[Important trends and insights]

## Conclusion
[Summary and takeaways]

## Sources
[Note any particularly valuable sources found]

Provide a well-researched, professional summary."""
        }]
    )

    return response.content[0].text


def research_agent_streaming(topic: str, model: str = "claude-sonnet-4-5") -> str:
    """
    Research agent with real-time streaming output.

    Shows research progress as it happens.
    """
    print(f"\nüîç Researching: {topic}")
    print("‚îÄ" * 60)

    summary = ""

    with client.messages.stream(
        model=model,
        max_tokens=4096,
        messages=[{
            "role": "user",
            "content": f"Research '{topic}' and provide a comprehensive summary."
        }]
    ) as stream:
        for text in stream.text_stream:
            print(text, end="", flush=True)
            summary += text

    print("\n" + "‚îÄ" * 60)
    return summary


def save_summary(topic: str, summary: str, output_dir: str = "research_output") -> str:
    """
    Save research summary to a markdown file.

    Args:
        topic: The research topic
        summary: The markdown summary
        output_dir: Directory to save files (created if doesn't exist)

    Returns:
        Path to the saved file
    """
    # Create output directory
    os.makedirs(output_dir, exist_ok=True)

    # Create safe filename with timestamp
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    safe_topic = topic.replace(' ', '_').lower()
    safe_topic = ''.join(c for c in safe_topic if c.isalnum() or c == '_')
    filename = f"{safe_topic}_{timestamp}.md"
    filepath = os.path.join(output_dir, filename)

    # Save to file
    with open(filepath, 'w', encoding='utf-8') as f:
        f.write(f"# Research Summary: {topic}\n\n")
        f.write(f"*Generated: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}*\n")
        f.write(f"*AI Research Agent powered by Claude*\n\n")
        f.write("---\n\n")
        f.write(summary)

    return filepath


def run_research(topic: str, stream: bool = True, save: bool = True) -> dict:
    """
    Main function to run the research agent.

    Args:
        topic: Topic to research
        stream: Show streaming output (default: True)
        save: Save to file (default: True)

    Returns:
        Dict with summary and optional filepath
    """
    # Research
    if stream:
        summary = research_agent_streaming(topic)
    else:
        print(f"üîç Researching: {topic}")
        summary = research_agent(topic)
        print("‚úÖ Research complete!")

    # Save
    result = {"summary": summary}

    if save:
        filepath = save_summary(topic, summary)
        result["filepath"] = filepath
        print(f"\nüíæ Saved to: {filepath}")

    return result


def main():
    """
    Interactive CLI for research agent.
    """
    print("=" * 60)
    print("AI Research Agent")
    print("Powered by Claude SDK")
    print("=" * 60)

    while True:
        print("\nWhat would you like to research?")
        print("(Enter 'quit' to exit)")
        print()

        topic = input("Topic: ").strip()

        if topic.lower() in ['quit', 'exit', 'q']:
            print("\nüëã Goodbye!")
            break

        if not topic:
            print("‚ùå Please enter a topic.")
            continue

        try:
            result = run_research(topic, stream=True, save=True)
            print(f"\nüìä Summary length: {len(result['summary'])} characters")

        except Exception as e:
            print(f"\n‚ùå Error: {e}")
            print("Please check your API key and try again.")


if __name__ == "__main__":
    main()
```

---

## Run the Agent

### Basic usage:

```bash
python research_agent.py
```

Then enter a topic when prompted:
```
Topic: AI agent frameworks in 2025
```

### Programmatic usage:

```python
from research_agent import run_research

result = run_research("AI agent frameworks in 2025")
print(result["filepath"])  # research_ai_agent_frameworks_in_2025_20251218_140523.md
```

---

## Example Output

```markdown
# Research Summary: AI agent frameworks in 2025

*Generated: 2025-12-18 14:05:23*
*AI Research Agent powered by Claude*

---

# AI Agent Frameworks in 2025

## Overview

The AI agent framework landscape in 2025 is dominated by several mature platforms that enable developers to build autonomous, multi-agent systems. The key players include Claude SDK (Anthropic), LangGraph (LangChain), OpenAI AgentKit, and Oracle ADK...

[Full research summary would appear here]
```

---

## Next Steps

**Extend this agent:**
1. Add multiple tool support (database queries, file operations)
2. Implement error handling and retry logic
3. Add cost tracking
4. Create a web interface
5. Deploy to production

**Learn more:**
- Study the `claude-sdk` skill for advanced patterns
- Check `langgraph-patterns` for complex orchestration
- See `intermediate/` examples for multi-agent systems

---

## Troubleshooting

**Error: "API key not found"**
- Ensure `.env` file exists with `ANTHROPIC_API_KEY`
- Check the key is valid

**Error: "Rate limit exceeded"**
- You're making too many requests
- Add delays between requests
- Upgrade your API plan

**Agent not finding good information**
- Make topic more specific
- Adjust the prompt instructions
- Try different model (Sonnet vs Haiku)

---

## Key Learnings

‚úÖ **Simple is powerful** - This 100-line agent is production-ready
‚úÖ **Streaming improves UX** - Real-time feedback builds user trust
‚úÖ **Clear instructions matter** - Good prompts = good results
‚úÖ **File operations are easy** - Claude SDK makes autonomy simple

**You just built your first AI agent! üéâ**

Next: Try the `simple-mcp-server/` example to learn data integration.

---

*Part of the FrankX AI Architect Skills package*
*For more examples, visit: frankx.ai/ai-architect-skills*
