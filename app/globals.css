@tailwind base;
@tailwind components;
@tailwind utilities;

/* ============================================================================
   TYPOGRAPHY SYSTEM
   Primary: Inter (geometric sans-serif, variable weight)
   Accent: Playfair Display (serif, italic emphasis only)
   Mono: JetBrains Mono (code blocks)
   All fonts loaded via Next.js Google Fonts optimization
   ============================================================================ */

@layer base {
  :root {
    color-scheme: dark;

    /* =========================================================================
       FRANKX BRAND v2.0 — Accent Colors (Feb 2026)
       ========================================================================= */

    /* Brand Accents */
    --brand-purple: #ab47c7; /* Intelligence, ACOS, primary brand */
    --brand-blue: #43bfe3; /* Technology, Vibe OS, architecture */
    --brand-magenta: #e040fb; /* GenCreator OS, multi-modal creation */
    --brand-emerald: #10b981; /* Success, Labs, CTAs */
    --brand-obsidian: #1e0a3c; /* Arcanea, cosmos, deep mystery */
    --brand-arcanea-glow: #7c3aed; /* Arcanea accent glow */
    --brand-gold: #f59e0b; /* Premium, exclusive tier */
    --brand-rose: #f43f5e; /* Errors, destructive actions */
    --brand-starlight: #38bdf8; /* Starlight meta-intelligence */
    --brand-navy: #0f172a; /* Brand primary dark */

    /* Legacy aliases */
    --brand-cyan: #43bfe3;
    --brand-amber: #f59e0b;

    /* =========================================================================
       SEMANTIC DESIGN TOKENS
       ========================================================================= */

    /* Backgrounds - Dark-first Foundation */
    --bg-void: #0a0a0b;
    --bg-space: #111113;
    --bg-elevated: #1a1a1f;
    --bg-subtle: #252530;
    --bg-muted: #3a3a4a;

    /* Text Hierarchy — Brand v2.0 WCAG compliant
       0.95 on #0a0a0b ≈ 18.5:1 (AAA)
       0.72 on #0a0a0b ≈ 11.2:1 (AAA)
       0.48 on #0a0a0b ≈ 7.5:1 (AAA)
       0.32 on #0a0a0b ≈ 5.0:1 (AA) */
    --text-primary: rgba(255, 255, 255, 0.95);
    --text-secondary: rgba(255, 255, 255, 0.72);
    --text-tertiary: rgba(255, 255, 255, 0.48);
    --text-muted: rgba(255, 255, 255, 0.32);
    --text-blog-body: rgba(255, 255, 255, 0.85);

    /* Border System — Hex for consistency */
    --border-subtle: #1f1f2f;
    --border-default: #2a2a3a;
    --border-strong: #3a3a4a;

    /* =========================================================================
       SHADCN/UI COMPATIBLE TOKENS
       ========================================================================= */
    --background: 222 83% 4%;
    --foreground: 210 40% 96%;
    --muted: 215 28% 17%;
    --muted-foreground: 215 20% 65%;
    --accent: 258 90% 66%;
    --accent-foreground: 217 91% 12%;
    --card: 222 83% 9%;
    --card-foreground: 210 40% 96%;
    --border: 215 28% 27%;
    --input: 215 28% 22%;
    --ring: 208 93% 58%;

    /* Primary accent mapped to brand emerald */
    --primary: var(--brand-emerald);
    --primary-foreground: var(--bg-void);

    /* Secondary accent mapped to brand cyan */
    --secondary: var(--brand-cyan);
    --secondary-foreground: var(--bg-void);

    /* =========================================================================
       MOTION TOKENS — CSS custom properties for non-Framer animation contexts
       Mirror values from lib/design/motion.ts for pure CSS transitions
       ========================================================================= */
    --motion-instant: 100ms;
    --motion-fast: 200ms;
    --motion-normal: 350ms;
    --motion-slow: 500ms;
    --motion-slowest: 700ms;

    /* M3 easing curves */
    --ease-emphasized: cubic-bezier(0.2, 0, 0, 1);
    --ease-emphasized-decelerate: cubic-bezier(0.05, 0.7, 0.1, 1);
    --ease-emphasized-accelerate: cubic-bezier(0.3, 0, 0.8, 0.15);
    --ease-standard: cubic-bezier(0.2, 0, 0, 1);
    --ease-standard-decelerate: cubic-bezier(0, 0, 0, 1);

    /* =========================================================================
       SURFACE STEPS — Radix UI-inspired tonal elevation system
       Step = how much white the surface contains above the void background.
       Use .surface-1 through .surface-5 classes instead of raw bg-white/N values.
       ========================================================================= */
    --surface-1: rgba(255, 255, 255, 0.02); /* Near-invisible — section bg */
    --surface-2: rgba(255, 255, 255, 0.04); /* Subtle card background */
    --surface-3: rgba(255, 255, 255, 0.06); /* Glass card */
    --surface-4: rgba(255, 255, 255, 0.09); /* Elevated card / hover */
    --surface-5: rgba(255, 255, 255, 0.13); /* Modal / floating surface */

    /* Brand-tinted surfaces — domain-colored cards */
    --surface-emerald: rgba(16, 185, 129, 0.06);
    --surface-purple: rgba(171, 71, 199, 0.06);
    --surface-cyan: rgba(67, 191, 227, 0.06);
    --surface-gold: rgba(245, 158, 11, 0.06);
    --surface-rose: rgba(244, 63, 94, 0.06);
  }

  /* Critical mobile fix: prevent horizontal overflow at the root level */
  html {
    overflow-x: hidden;
    scroll-behavior: smooth;
  }

  body {
    background-color: hsl(var(--background));
    color: hsl(var(--foreground));
    overflow-x: hidden;
    position: relative;
  }
}

@layer utilities {
  .text-balance {
    text-wrap: balance;
  }

  /* Safe area support for mobile devices with notches */
  .safe-area-bottom {
    padding-bottom: env(safe-area-inset-bottom);
  }

  .safe-area-top {
    padding-top: env(safe-area-inset-top);
  }

  .safe-area-left {
    padding-left: env(safe-area-inset-left);
  }

  .safe-area-right {
    padding-right: env(safe-area-inset-right);
  }

  /* Playfair Display italic for quotes & editorial emphasis */
  .font-serif-italic {
    font-family: var(--font-serif), "Playfair Display", Georgia, serif;
    font-style: italic;
    font-weight: 400;
  }

  /* Poppins display font for headings ≥18px */
  .font-display {
    font-family: var(--font-poppins), "Poppins", system-ui, sans-serif;
  }

  .gradient-text {
    background-image: linear-gradient(135deg, #ab47c7, #43bfe3);
    -webkit-background-clip: text;
    color: transparent;
  }

  .gradient-bg {
    background-image: linear-gradient(135deg, #0a0a0b, #111113, #0f172a);
  }

  /* Glassmorphism — Use Tailwind classes from lib/design/tokens.ts surface system
     Canonical: backdrop-blur-xl bg-white/5 border border-white/10
     See also: glassCardClasses in lib/design/gradients.ts */

  /* ==========================================================================
     ACCESSIBLE TEXT UTILITIES - Use instead of raw opacity values
     These map to CSS variables with WCAG-compliant contrast ratios
     ========================================================================== */
  .text-brand-primary {
    color: var(--text-primary);
  }
  .text-brand-secondary {
    color: var(--text-secondary);
  }
  .text-brand-tertiary {
    color: var(--text-tertiary);
  }
  .text-brand-muted {
    color: var(--text-muted);
  }
  .text-blog-body {
    color: var(--text-blog-body);
  }

  /* Background utilities using design tokens */
  .bg-void {
    background-color: var(--bg-void);
  }
  .bg-space {
    background-color: var(--bg-space);
  }
  .bg-elevated {
    background-color: var(--bg-elevated);
  }
  .bg-subtle {
    background-color: var(--bg-subtle);
  }

  /* Border utilities using design tokens */
  .border-brand-subtle {
    border-color: var(--border-subtle);
  }
  .border-brand-default {
    border-color: var(--border-default);
  }
  .border-brand-strong {
    border-color: var(--border-strong);
  }

  /* Premium hover lift — reusable card elevation on hover */
  .card-hover-lift {
    transition:
      transform 0.3s ease,
      box-shadow 0.3s ease;
  }
  .card-hover-lift:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 40px rgb(0 0 0 / 0.25);
  }

  /* Premium card — glassmorphic surface for Watch page and similar dark UIs */
  .card-premium {
    background: rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(18px);
    -webkit-backdrop-filter: blur(18px);
    border: 1px solid rgba(255, 255, 255, 0.08);
    box-shadow: 0 20px 60px rgb(8 15 33 / 0.45);
  }
}

/* ============================================================================
   FLUID TYPOGRAPHY — Viewport-responsive type using CSS clamp()
   Eliminates jump-at-breakpoint layout shifts; text scales smoothly.
   Usage: replace "text-4xl lg:text-5xl" with "text-fluid-4xl"
   ============================================================================ */
@layer utilities {
  .text-fluid-xs {
    font-size: clamp(0.75rem, 0.7rem + 0.25vw, 0.875rem);
  }
  .text-fluid-sm {
    font-size: clamp(0.875rem, 0.8rem + 0.5vw, 1rem);
  }
  .text-fluid-base {
    font-size: clamp(1rem, 0.9rem + 0.5vw, 1.125rem);
  }
  .text-fluid-lg {
    font-size: clamp(1.125rem, 1rem + 0.75vw, 1.25rem);
  }
  .text-fluid-xl {
    font-size: clamp(1.25rem, 1.1rem + 1vw, 1.5rem);
  }
  .text-fluid-2xl {
    font-size: clamp(1.5rem, 1.2rem + 1.5vw, 2rem);
  }
  .text-fluid-3xl {
    font-size: clamp(1.875rem, 1.4rem + 2.5vw, 2.5rem);
  }
  .text-fluid-4xl {
    font-size: clamp(2.25rem, 1.5rem + 3.5vw, 3.5rem);
  }
  .text-fluid-5xl {
    font-size: clamp(3rem, 2rem + 5vw, 4.5rem);
  }
  .text-fluid-6xl {
    font-size: clamp(3.75rem, 2.5rem + 7vw, 6rem);
  }
  .text-fluid-7xl {
    font-size: clamp(4.5rem, 3rem + 9vw, 8rem);
  }
}

/* ============================================================================
   FONT FEATURE SETTINGS — Precision typographic rendering
   ============================================================================ */
@layer utilities {
  /* Tabular numerics — for stats, prices, counters, data tables */
  .font-nums {
    font-feature-settings: "tnum", "lnum";
    font-variant-numeric: tabular-nums lining-nums;
  }
  /* Ligatures + contextual alternates — for headlines, editorial text */
  .font-liga {
    font-feature-settings:
      "liga" 1,
      "calt" 1;
  }
  /* Display rendering — ligatures + anti-aliasing for large text */
  .font-display-render {
    font-feature-settings:
      "liga" 1,
      "calt" 1,
      "ss01" 1;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
  /* Antialiased — all body text on dark backgrounds */
  .antialiased-dark {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
}

/* ============================================================================
   SURFACE STEPS — Semantic elevation using CSS custom properties
   Replaces hardcoded bg-white/N values for consistent surface depth.
   ============================================================================ */
@layer utilities {
  .surface-1 {
    background: var(--surface-1);
  }
  .surface-2 {
    background: var(--surface-2);
  }
  .surface-3 {
    background: var(--surface-3);
  }
  .surface-4 {
    background: var(--surface-4);
  }
  .surface-5 {
    background: var(--surface-5);
  }
}

/* ============================================================================
   TINTED GLASS — Brand-colored glassmorphic surfaces
   Each includes saturate() for Apple-style vibrancy effect.
   ============================================================================ */
@layer utilities {
  .glass-emerald {
    background: var(--surface-emerald);
    backdrop-filter: blur(20px) saturate(160%);
    -webkit-backdrop-filter: blur(20px) saturate(160%);
    border: 1px solid rgba(16, 185, 129, 0.15);
  }
  .glass-purple {
    background: var(--surface-purple);
    backdrop-filter: blur(20px) saturate(160%);
    -webkit-backdrop-filter: blur(20px) saturate(160%);
    border: 1px solid rgba(171, 71, 199, 0.15);
  }
  .glass-cyan {
    background: var(--surface-cyan);
    backdrop-filter: blur(20px) saturate(160%);
    -webkit-backdrop-filter: blur(20px) saturate(160%);
    border: 1px solid rgba(67, 191, 227, 0.15);
  }
  .glass-gold {
    background: var(--surface-gold);
    backdrop-filter: blur(20px) saturate(160%);
    -webkit-backdrop-filter: blur(20px) saturate(160%);
    border: 1px solid rgba(245, 158, 11, 0.15);
  }
  /* Vibrancy glass — Apple-style maximum translucency with saturation boost */
  .glass-vibrancy {
    background: rgba(255, 255, 255, 0.04);
    backdrop-filter: blur(40px) saturate(200%) brightness(108%);
    -webkit-backdrop-filter: blur(40px) saturate(200%) brightness(108%);
    border: 1px solid rgba(255, 255, 255, 0.12);
  }
}

/* ============================================================================
   MOTION UTILITIES — CSS transition shortcuts using design token vars
   ============================================================================ */
@layer utilities {
  .transition-instant {
    transition-duration: var(--motion-instant);
    transition-timing-function: var(--ease-standard);
  }
  .transition-fast {
    transition-duration: var(--motion-fast);
    transition-timing-function: var(--ease-standard);
  }
  .transition-normal {
    transition-duration: var(--motion-normal);
    transition-timing-function: var(--ease-emphasized);
  }
  .transition-slow {
    transition-duration: var(--motion-slow);
    transition-timing-function: var(--ease-emphasized-decelerate);
  }
}

/* ============================================================================
   SCROLLBAR STYLING — Thin, dark-mode aware custom scrollbars
   ============================================================================ */
@layer utilities {
  .scrollbar-thin {
    scrollbar-width: thin;
    scrollbar-color: rgba(255, 255, 255, 0.15) transparent;
  }
  .scrollbar-thin::-webkit-scrollbar {
    width: 4px;
    height: 4px;
  }
  .scrollbar-thin::-webkit-scrollbar-track {
    background: transparent;
  }
  .scrollbar-thin::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.15);
    border-radius: 2px;
  }
  .scrollbar-thin::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.28);
  }
}

/* ============================================================================
   CSS HOUDINI: Animatable shimmer angle property
   @property enables smooth conic-gradient rotation without the 200%×200% div hack.
   Browser support: Chrome 85+, Edge 85+, Safari 16.4+ (~94% global coverage)
   ============================================================================ */
@property --shimmer-angle {
  syntax: '<angle>';
  initial-value: 0deg;
  inherits: false;
}

@keyframes shimmer-spin {
  to { --shimmer-angle: 360deg; }
}

@keyframes eq {
  0%, 100% { height: 4px; }
  50% { height: 16px; }
}

/* ── Shimmer border utility classes ── */
@layer utilities {
  /* Always-on shimmer border */
  .shimmer-border {
    --shimmer-color-1: #AB47C7;
    --shimmer-color-2: #43BFE3;
    background: conic-gradient(
      from var(--shimmer-angle),
      transparent 60%,
      var(--shimmer-color-1) 70%,
      var(--shimmer-color-2) 80%,
      transparent 90%
    );
    animation: shimmer-spin 3s linear infinite;
  }
  .shimmer-border-fast { animation: shimmer-spin 1.5s linear infinite; }
  .shimmer-border-slow { animation: shimmer-spin 5s linear infinite; }

  /* Hover-only shimmer — add .shimmer-hover-parent to the wrapper */
  .shimmer-border-hover {
    background: conic-gradient(
      from var(--shimmer-angle),
      transparent 60%,
      #AB47C7 70%,
      #43BFE3 80%,
      transparent 90%
    );
    animation: none;
    opacity: 0;
    transition: opacity 0.4s ease;
  }
  .shimmer-hover-parent:hover .shimmer-border-hover {
    animation: shimmer-spin 2.5s linear infinite;
    opacity: 1;
  }

  /* Color variant overrides */
  .shimmer-gold {
    --shimmer-color-1: #F59E0B;
    --shimmer-color-2: #FB923C;
  }
  .shimmer-emerald {
    --shimmer-color-1: #10B981;
    --shimmer-color-2: #06B6D4;
  }
  .shimmer-ice {
    --shimmer-color-1: rgba(255, 255, 255, 0.7);
    --shimmer-color-2: #43BFE3;
  }
  .shimmer-rainbow {
    /* Override background for multi-stop rainbow */
    background: conic-gradient(
      from var(--shimmer-angle),
      transparent 50%,
      #10B981 60%,
      #43BFE3 70%,
      #AB47C7 80%,
      #F59E0B 90%,
      transparent 95%
    ) !important;
  }
}

/* Film-grain overlay — subtle noise texture for depth */
.grain-overlay::after {
  content: "";
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 1;
  opacity: 0.03;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
}

/* Scrollbar-hidden utility for carousels */
@layer utilities {
  .no-scrollbar::-webkit-scrollbar {
    display: none;
  }
  .no-scrollbar {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
}

.sr-only {
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0, 0, 0, 0) !important;
  white-space: nowrap !important;
  border: 0 !important;
}

.skip-to-content {
  position: absolute;
  left: -9999px;
  top: auto;
  width: 1px;
  height: 1px;
  overflow: hidden;
}

.skip-to-content:focus {
  left: 1rem;
  top: 1rem;
  width: auto;
  height: auto;
  padding: 0.75rem 1.5rem;
  background: linear-gradient(135deg, #ab47c7, #43bfe3);
  color: #ffffff;
  border-radius: 0.5rem;
  box-shadow: 0 12px 40px rgba(14, 165, 233, 0.45);
  z-index: 9999;
  text-decoration: none;
}

/* ============================================================================
   ARTICLE TYPOGRAPHY — Blog & Guide reading experience
   Custom list markers, blockquote treatment, prose rhythm
   ============================================================================ */

/* Unordered list: emerald dot markers */
.article-list li::before {
  content: "";
  position: absolute;
  left: 0;
  top: 0.7em;
  width: 5px;
  height: 5px;
  border-radius: 9999px;
  background-color: rgb(52 211 153 / 0.6); /* emerald-400/60 */
}

/* Ordered list: emerald numbered markers */
.article-ol {
  counter-reset: article-counter;
}

.article-ol li {
  counter-increment: article-counter;
}

.article-ol li::before {
  content: counter(article-counter) ".";
  position: absolute;
  left: 0;
  top: 0;
  font-size: 0.85em;
  font-weight: 600;
  font-variant-numeric: tabular-nums;
  color: rgb(52 211 153 / 0.7); /* emerald-400/70 */
}

/* Blockquote serif treatment */
.article-blockquote {
  font-family: var(--font-serif), "Playfair Display", Georgia, serif;
  font-style: italic;
}

/* Code block line-number gutter (future enhancement hook) */
.article-code-block {
  tab-size: 2;
  -moz-tab-size: 2;
}

/* Smooth anchor scroll for heading links */
.article-heading-anchor {
  scroll-margin-top: 6rem;
}

/* Accessibility: Respect reduced motion preferences */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}
